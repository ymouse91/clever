/* =========================================================
   Clever (PWA) – styles.css  —  korjattu 26.8.2025
   ========================================================= */

:root{
  /* Väliarvot */
  --col-gap: 12px;   /* vasen ↔ oikea sarake väli */
  --row-gap-left: 12px;   /* Keltainen ↕ Sininen väli */
  --row-gap-right: 12px;  /* Vihreä ↕ Oranssi ↕ Violetti välit */

  --cell: 34px;      /* ruutujen korkeus (perus) */
  --cell-lg: 36px;   /* ruutujen korkeus leveällä näytöllä */

  /* Teema */
  --bg:#0b0e14;
  --fg:#eef2f7;
  --muted:#a9b2c3;
  --accent:#000000;
  --panel:#777777;   /* korjattu */
  --border:#252c3a;

  /* Värit */
  --yellow:#ffe08a;
  --blue:#9bd0ff;
  --green:#a8f0b1;
  --orange:#ffc299;
  --purple:#d3b5ff;
}

/* Yleinen typografia / tausta */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--fg);
  background:linear-gradient(180deg,#0b0e14,#111626 40%,#0b0e14);
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}

/* Topbar */
.topbar{
  position:sticky; top:0; z-index:10;
  background:rgba(11,14,20,.9); backdrop-filter:blur(6px);
  border-bottom:1px solid var(--border);
  padding:.5rem 1rem;
  display:flex; flex-wrap:wrap; align-items:center; gap:.75rem;
}
.title{font-weight:700}
.hud{display:flex; gap:1rem; color:var(--muted); font-size:.95rem; flex:1}
.actions{display:flex; gap:.5rem}
.btn{
  border:1px solid var(--border); background:#151b2a; color:var(--fg);
  padding:.45rem .7rem; border-radius:.55rem; cursor:pointer;
}
.btn.primary{background:var(--accent); border-color:#0b5ed7}
.btn:disabled{opacity:.5; cursor:not-allowed}

main{padding:1rem}

/* ===================== NOPAT ===================== */
.dice-section{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:.7rem;
  padding:.75rem;
  margin-bottom:1rem;
}
.dice-lane{
  display:grid; grid-template-columns:1fr 1fr; gap:.75rem; align-items:start;
}
.dice-col h3{
  margin:0 0 .25rem 0;
  color:#fff;                /* Heitetyt nopat & Hopealautanen valkoiseksi */
  font-size:.9rem;
  font-weight:600;
}

.dice-row{display:flex; gap:.4rem; flex-wrap:wrap; min-height:56px}
#dice-silver{min-height:56px}

.die{
  width:54px; height:54px; border-radius:.6rem;
  background:#1c2334; border:1px solid var(--border);
  display:grid; place-items:center; font-weight:700; font-size:1.05rem; user-select:none;
}
.die.selected{ outline:3px solid #ffd54d; outline-offset:2px; }

/* nopan värit */
.die.white{background:#f5f7fb; color:#111; border-color:#cfd7e6}
.die.yellow{background:var(--yellow); color:#111}
.die.blue{background:var(--blue); color:#112}
.die.green{background:var(--green); color:#112}
.die.orange{background:var(--orange); color:#112}
.die.purple{background:var(--purple); color:#112}

/* hopealautanen */

.dice-ctrls{display:flex; gap:.4rem; margin-top:.5rem; flex-wrap:wrap}
.status{margin-top:.4rem; color:var(--muted)}

/* ===================== PISTETAULUKKO ===================== */
.sheet{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:.7rem;
  padding:.75rem;
}
.sheet h2{margin:.1rem 0 .5rem 0}

/* --- KAKSIPALSTAINEN RUNKO --- */
.sheet-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  column-gap: var(--col-gap);
  align-items:stretch;               /* ▼ venyttää sarakkeet yhtä korkeiksi */
}

/* vasen ja oikea pino */
.left-stack{
  display:flex; flex-direction:column;
  row-gap: var(--row-gap-left);
  height:100%;
}
.right-stack{
  display:grid;
  grid-template-rows:1fr 1fr 1fr;    /* kolme yhtä korkeaa */
  row-gap: var(--row-gap-right);
  height:100%;
}

/* Paneelikortti (kehys) */
.panel{
  background:#101522;
  border:1px solid var(--border);
  border-radius:.7rem;
  padding:.6rem;
  display:flex; flex-direction:column;
  min-height:0;
}
.panel-title{font-weight:700; margin:0 0 .4rem 0}
.panel-note{color:var(--muted); font-size:.85rem; margin:.3rem 0 0}

/* ===================== KELTAINEN ===================== */
.panel.yellow .grid{
  display:grid; grid-template-columns:repeat(4,1fr); gap:.3rem;
}
.cell{
  height:var(--cell);
  border:1px solid var(--border);
  border-radius:.4rem;
  display:grid; place-items:center;
  background:#0f1421;
  font-weight:700; font-size:1.02rem;
  cursor:pointer; color:var(--fg);
}
.cell.marked{background:var(--yellow); color:#111; border-color:#e9c96e}
.cell.highlight{outline:2px solid var(--accent); outline-offset:2px}

/* ===================== SININEN ===================== */
.panel.blue .track{
  display:grid;
  grid-template-columns:repeat(4, minmax(var(--cell),1fr)); /* 4 saraketta */
  gap:.3rem;
}
.box{
  height:var(--cell);
  border:1px solid var(--border); border-radius:.4rem;
  display:grid; place-items:center;
  background:#0f1421; cursor:pointer; font-weight:700; color:var(--fg);
}
.box.marked{background:var(--blue); color:#112; border-color:#77bff5}

/* ===================== VIHREÄ / ORANSSI / VIOLETTI ===================== */
.panel.green .row,
.panel.orange .row,
.panel.purple .row{
  display:grid;
  grid-template-columns:repeat(10, minmax(var(--cell),1fr));
  gap:.3rem;
}
.slot{
  height:var(--cell);
  border:1px solid var(--border); border-radius:.4rem;
  display:grid; place-items:center;
  background:#0f1421; cursor:pointer; font-weight:700; color:var(--fg);
  position:relative;
}

/* Täyttö väreillä */
.panel.green  .slot.marked{ background:var(--green);  color:#112; border-color:#7bd68a }
.panel.orange .slot.marked{ background:var(--orange); color:#112; border-color:#ffb07a }
.panel.purple .slot.marked{ background:var(--purple); color:#112; border-color:#c39aff }

.panel.orange .slot .val,
.panel.purple .slot .val{ color:inherit; }

.slot.x2::after{
  content:"x2"; position:absolute; top:4px; left:6px; font-size:.8rem; color:var(--muted);
}
.panel.orange .slot.x2.marked::after{ color:rgba(0,0,0,.6); font-weight:600; }
.slot .tiny{ position:absolute; bottom:4px; right:6px; font-size:.8rem; color:var(--muted); }

/* ===================== FOOTER / SCORE ===================== */
.sheet-footer{display:flex; align-items:center; gap:1rem; margin-top:.75rem}
#score-out{color:#fff; font-weight:700}

/* ===================== Dialogit ===================== */
dialog{
  border:none; border-radius:.7rem; padding:1rem .9rem .7rem;
  background:#0f1421; color:#fff; max-width:560px;
}
dialog::backdrop{background:rgba(0,0,0,.6)}
dialog h3{margin:.2rem 0 .5rem}
dialog .right{display:flex; justify-content:flex-end; margin-top:.5rem}
.white-choices{display:flex; gap:.5rem; flex-wrap:wrap}

/* ===================== Responsiivinen ===================== */
@media (min-width:1024px){
  :root{ --cell: var(--cell-lg); }
  #dice-silver{ min-height:70px; }
}
/* ===================== BONUSMERKINNÄT===================== */

#yellow-grid { position: relative; }
#yellow-grid .cell {
  position: relative; /* ankkuroi badge solun kulmaan */
}

#yellow-grid .y-badge {
  position: absolute;
  font-size: 10px;
  line-height: 1;
  padding: 2px 6px;
  border-radius: 10px;
  background: #cbd5e1;   /* harmaa pilleri */
  color: #111827;
  opacity: .85;
  pointer-events: none;   /* ei varasta klikkauksia */
  white-space: nowrap;
}

/* rivi-badge oikea-alakulmaan */
#yellow-grid .y-badge-row {
  right: 6px;
  bottom: 6px;
}

/* sarake-badge vasen-yläkulmaan */
#yellow-grid .y-badge-col {
  left: 6px;
  top: 6px;
}

/* syttynyt bonus */
#yellow-grid .y-badge.earned {
  background: #16a34a; /* vihreä */
  color: #fff;
  opacity: 1;
}

#blue-track .box { position: relative; }

#blue-track .b-badge {
  position: absolute;
  font-size: 9px;
  line-height: 1;
  padding: 2px 4px;
  border-radius: 8px;
  background: #cbd5e1;
  color: #111827;
  opacity: .85;
  white-space: nowrap;
  pointer-events: none;
}

#blue-track .b-badge-row { right: 4px; bottom: 4px; }
#blue-track .b-badge-col { left: 4px; top: 4px; }

#blue-track .b-badge.earned {
  background: #16a34a;
  color: #fff;
  opacity: 1;
}

#green-row .slot,
#orange-row .slot,
#purple-row .slot {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;               /* kapea leveys */
  height: 60px;              /* selvästi korkeampi */
  margin: 2px;
  border: 1px solid #444;
  border-radius: 4px;
  font-size: 16px;
  line-height: 1.2;
  box-sizing: border-box;
}

/* Numerot */
#green-row .slot .val,
#orange-row .slot .val,
#purple-row .slot .val {
  z-index: 1;
}

/* Bonusbadget */
/* vaihtoehto B – keskelle alalaitaan */
.g-badge, .o-badge, .p-badge {
  position: absolute;
  left: 50%;
  bottom: 4px;
  transform: translateX(-50%); /* ← keskitys */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 2px 6px;

  font-size: 11px;
  line-height: 1;
  border-radius: 999px;
  background: #cbd5e1;
  color: #111827;
  opacity: .85;
  white-space: nowrap;
  pointer-events: none;
}

.g-badge.earned,
.o-badge.earned,
.p-badge.earned {
  background: #16a34a;
  color: #fff;
  opacity: 1;
}

/* 1) Hopealautasen peruskehys: musta dashed */
#dice-silver .die.silver {
  outline: 2px dashed #000 !important;
  outline-offset: 0;
  border: none !important;
  box-shadow: none !important;
}

/* 2) Kun noppa on valittavissa (clickable): valkoinen dashed */
#dice-silver .die.silver.clickable {
  outline: 2px dashed #fff !important;   /* ei enää var(--accent) */
  outline-offset: 2px;
  cursor: pointer;
}

/* 3) Kun sekä clickable että selected: lukitse valkoiseksi ja solidiksi
      (ohittaa yleisen .die.selected { outline: 3px solid #ffd54d; }) */
#dice-silver .die.silver.clickable.selected {
  outline: 3px solid #fff !important;
  outline-offset: 2px;
}

#dice-silver .die.silver.armed {
  outline: 3px solid #fff !important;
  outline-offset: 2px;
}
#dice-silver .die.disabled {
  opacity: 0.5;
  outline: none !important; /* poistaa katkoviivan */
  pointer-events: none; /* varmuuden vuoksi */
}

/* ===================== PWA SAFE AREA FIX (iOS) ===================== */
:root {
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  min-height: 100dvh;              /* moderni korjaus */
  min-height: 100svh;
  min-height: -webkit-fill-available; /* fallback vanhemmille iOS:lle */
}

body {
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
  padding-left: var(--safe-left);
  padding-right: var(--safe-right);
  background: linear-gradient(180deg,#0b0e14,#111626 40%,#0b0e14);
}

/* ============ Phone-only layout: pinota paneelit allekkain ============ */
/* Rajaus ~iPhone leveydelle; iPad (≥768px) ei muutu */
@media (max-width: 600px) {
  /* Korvaa 2-palstainen grid pystysuuntaisella pinolla */
  .sheet-grid {
    display: flex;
    flex-direction: column;
    gap: var(--row-gap-left);
  }

  /* Poista stack-konttien oma asettelu, käytä vain paneeleita peräkkäin */
  .left-stack,
  .right-stack {
    display: contents;  /* säilyttää lasten DOM-järjestyksen: Y, B, G, O, P */
  }

  /* Varmista mukava väli paneelien väliin */
  .panel { margin-bottom: var(--row-gap-left); }
  .panel:last-child { margin-bottom: 0; }

  /* (Valinnainen) jos haluat myös nopat päällekkäin iPhonessa:
  .dice-lane { grid-template-columns: 1fr; }
  */
}
/* ================== Phone-only: jaa 10 slotin rivit kahteen 5+5 ================== */
@media (max-width: 600px) {
  .panel.green .row,
  .panel.orange .row,
  .panel.purple .row {
    grid-template-columns: repeat(5, minmax(var(--cell), 1fr));
    grid-auto-rows: auto;   /* luo toisen rivin automaattisesti */
  }
}
